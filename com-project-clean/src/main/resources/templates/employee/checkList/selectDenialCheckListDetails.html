<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org"
	  xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity5">
<head>
<meta charset="UTF-8">
<title>Project Clean</title>
<link rel="stylesheet"
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" >
<link rel="stylesheet" type="text/css"
	th:href="@{/css/employee/checklist/checkList.css}">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>	

</head>
<body>

<section>
	<form method="post" action="admin/checklist/denial"  enctype="multipart/form-data">
	
		<input type="hidden" th:value="${checkList.checkReservationNo}" class="reservationNo" name="reservationNo"> 
		
		<p th:utext="${checkList.checkHTML}" class="jbHtml"></p>			
		
		  <th:block th:if="${ checkList.checkStatus == 'D' }">	
		  
	        <div class="employeeOpnionArea">
	            <label>직원 답변</label><br>
	            <textarea class="Opnion" cols="100%" rows="3"></textarea>
	            <br>
	    	</div>
	    	
	    </th:block>
		<br><br>				
	</form>
</section>

	<th:block th:if="${ checkList.checkStatus == 'D' }">	
	    <input type="button" value="등록" id="submit">
	</th:block>
	
<!-- Submit script -->
    <script>
	    
	    const jbHtml = "";
    	
    	document.getElementById("submit").onclick = function(){
			const reservationNo = $('.reservationNo').val();
    			const jbHtml = $( 'section' ).html();
    		if(confirm("사유서를 제출하시겠습니까? 담당 관리자에게 알람이 전송됩니다.")){
    			$.ajax({
    				url: "accpet",
    				type:"POST",
    				data:{	
    					jbHtml : jbHtml,
    					reservationNo : reservationNo
    				},
    				
    				success: function(data){
    					location.href="/employee/checkList/selectMyCheckList"
		    			alert("전송 완료");
						
    				},
    				error : function(request, status){
    					alert("전송 실패")
    				}
    			})
    		 } 
    	}

    </script>	

<!-- checkbox sciprt -->
	<script>
		const checkboxs = document.querySelectorAll('form .checklist .checkbox');
			for(let i =0; i < checkboxs.length; i++){
				const checkbox = checkboxs[i]
				if(checkbox.value == "NOT"){
					$(checkbox).attr("disabled", true)
				} else if(checkbox.value == "YES") {
					$(checkbox).attr("checked",true)
					$(checkbox).attr("disabled", true)
				};
		};
	</script>


</body>
</html>